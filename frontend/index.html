<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Stock Analysis Dashboard</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="style.css"/>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="./app.js" defer></script>
</head>

<body>
  <div class="app">
    <!-- Topbar -->
    <header class="topbar">
      <div class="brand">
        <div class="logoMark">‚ñÆ‚ñÆ‚ñÆ</div>
        <div class="brandText">
          <div class="title">Stock Analysis Dashboard</div>
          <div class="sub">Quick Insight + Financial Trends</div>
        </div>
      </div>

      <div class="topActions">
        <div class="iconBtn" id="themeToggle" title="Toggle Theme">üåô</div>
        <div class="iconBtn" title="Notifications">üîî</div>
        <div class="iconBtn" title="Settings">‚öôÔ∏è</div>
        <div class="iconBtn" title="Menu">‚ò∞</div>

      </div>
    </header>

    <main class="main">
      <!-- Hero / Quick Insight -->
      <section class="hero card">
        <div class="heroHead">
          <div class="heroLeft">
            <h2>Quick Insight</h2>
            <p class="muted">Summary generated based on key financial metrics and trends.</p>
            <div class="metaRow">
              <span class="pill">Source: <b id="sourceInfo">‚Äî</b></span>
              <span class="pill">Status: <b id="statusText">Ready</b></span>
            </div>
          </div>

          <form id="queryForm" class="searchBar">
            <input id="symbolInput" type="text" placeholder="Enter stock symbol..." autocomplete="off" />
            <input id="fileInput" type="text" placeholder="or filename (optional)..." autocomplete="off" />
            <button class="btn" type="submit">Search</button>
          </form>
        </div>

        <!-- status toast -->
        <div id="status" class="statusArea"></div>

        <!-- Quality / Insight cards -->
        <div class="qualityBlock">
          <div class="qualityTitle">
            <span class="dot ok"></span>
            <h3>Quality</h3>
          </div>

          <div class="insightGrid">
            <div class="insightCard">
              <div class="icn red">üìâ</div>
              <div>
                <div class="iTitle">Declining</div>
                <div class="iSub">ROE & Margins</div>
              </div>
            </div>

            <div class="insightCard">
              <div class="icn amber">üí∞</div>
              <div>
                <div class="iTitle">Cash Flow</div>
                <div class="iSub">Negative FCF Growth</div>
              </div>
            </div>

            <div class="insightCard">
              <div class="icn pink">‚ö†Ô∏è</div>
              <div>
                <div class="iTitle">Risk</div>
                <div class="iSub">High Debt Levels</div>
              </div>
            </div>

            <div class="insightCard danger">
              <div class="icn danger">üßæ</div>
              <div>
                <div class="iTitle">Verdict</div>
                <div class="iSub">Not Attractive at Current Price</div>
              </div>
            </div>
          </div>

          <div class="qualityFoot muted">Summary generated based on key financial metrics and trends.</div>
        </div>
      </section>

      <!-- KPI Row (‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏ó‡∏µ‡πà app.js ‡∏à‡∏∞ render ‡πÉ‡∏™‡πà #kpiCards) -->
      <section class="kpiWrap card">
        <div class="sectionHead">
          <h3>Key Performance Indicators</h3>
          <div class="rightHint muted">auto from result.json</div>
        </div>
        <div id="kpiCards" class="kpiGrid"></div>
      </section>

      <!-- Profitability & Valuation Trends (combined chart) -->
      <section class="card">
        <div class="sectionHead">
          <h3>Profitability & Valuation Trends</h3>
          <div class="rightHint muted">ROE / ROA / PE / PBV / ROIC / PRICE</div>
        </div>
        <div class="chartBox tall">
          <canvas id="combinedChart"></canvas>
        </div>
        <p class="muted note">
          Hint: ‡∏ñ‡πâ‡∏≤‡πÄ‡∏™‡πâ‡∏ô‡πÄ‡∏¢‡∏≠‡∏∞‡∏à‡∏ô‡∏£‡∏Å ‡πÉ‡∏´‡πâ‡∏ã‡πà‡∏≠‡∏ô‡∏ö‡∏≤‡∏á dataset ‡∏ú‡πà‡∏≤‡∏ô legend ‡πÑ‡∏î‡πâ (‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏™‡πâ‡∏ô)
        </p>
      </section>

      <!-- 2-up charts -->
      <section class="grid2">
        <div class="card">
          <div class="sectionHead">
            <h3>Free Cash Flow Analysis</h3>
            <div class="rightHint muted">FCF + Growth%</div>
          </div>
          <div class="chartBox">
            <canvas id="fcfComboChart"></canvas>
          </div>
        </div>

        <div class="card">
          <div class="sectionHead">
            <h3>Operating Cash Flow Analysis</h3>
            <div class="rightHint muted">OCF + Growth%</div>
          </div>
          <div class="chartBox">
            <canvas id="ocfComboChart"></canvas>
          </div>
        </div>
      </section>

      <!-- Ratio Tabs + 2 charts -->
      <section class="card">
        <div class="sectionHead">
          <h3>Ratio Explorer</h3>
          <div class="rightHint muted">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡πÅ‡∏•‡πâ‡∏ß‡∏î‡∏π 2 ‡∏Å‡∏£‡∏≤‡∏ü‡∏Ñ‡∏π‡πà</div>
        </div>

        <div class="tabs" id="ratioTabs"></div>

        <div class="grid2">
          <div class="miniCard">
            <div class="miniHead">
              <div id="rTitle1" class="miniTitle">‚Äî</div>
            </div>
            <div class="chartBox small">
              <canvas id="rChart1"></canvas>
            </div>
          </div>

          <div class="miniCard">
            <div class="miniHead">
              <div id="rTitle2" class="miniTitle">‚Äî</div>
            </div>
            <div class="chartBox small">
              <canvas id="rChart2"></canvas>
            </div>
          </div>
        </div>
      </section>
      <section class="card">
        <div class="container">
          <h1>AI Investment Insight</h1>
          <div class="subtitle">
            ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏î‡∏¢ GPT ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏á‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô & Valuation ‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö
          </div>
        
          <!--button onclick="loadAI()">Run AI Analysis</!--button-->
        
          <div class="card">
            <h3>üè≠ ‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à</h3>
            <div id="aiQuality" class="text loading">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå...</div>
          </div>
        
          <div class="card">
            <h3>üí∞ ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤</h3>
            <div id="aiValuation" class="text loading">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå...</div>
          </div>
        
          <div class="card">
            <h3>‚ö†Ô∏è ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á</h3>
            <div id="aiRisk" class="text loading">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå...</div>
          </div>
        
          <div class="card">
            <h3>üìå ‡∏°‡∏∏‡∏°‡∏°‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô</h3>
            <div id="aiView" class="text loading">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå...</div>
          </div>
        </div>
      </section>
      <!--section class="grid3">
        <div class="card">
          <h4>Quality</h4>
          <div class="badge" id="quatilyStatus">-</div>
          <p id="qualityReason">-</p>
        </div>

      </section-->

      <!-- Financial Overview table (placeholder) -->
      <section class="card">
        <div class="sectionHead">
          <h3>Financial Overview</h3>
          <div class="actions">
            <button class="btnGhost" type="button">Export</button>
            <button class="btnGhost" type="button">More Details</button>
          </div>
        </div>

        <!-- ‡∏ñ‡πâ‡∏≤‡∏ô‡∏≤‡∏¢‡∏≠‡∏¢‡∏≤‡∏Å render ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏≤‡∏Å result.json ‡∏Ñ‡πà‡∏≠‡∏¢‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏° -->
        <div class="tableWrap">
          <table class="table">
            <thead>
              <tr>
                <th>Metric</th>
                <th>2020</th>
                <th>2021</th>
                <th>2022</th>
                <th>2023</th>
                <th>2024</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Total Revenue</td>
                <td>‚Äî</td><td>‚Äî</td><td>‚Äî</td><td>‚Äî</td><td>‚Äî</td>
              </tr>
              <tr>
                <td>Net Income</td>
                <td>‚Äî</td><td>‚Äî</td><td>‚Äî</td><td>‚Äî</td><td>‚Äî</td>
              </tr>
              <tr>
                <td>Free Cash Flow</td>
                <td>‚Äî</td><td>‚Äî</td><td>‚Äî</td><td>‚Äî</td><td>‚Äî</td>
              </tr>
              <tr>
                <td>WACC</td>
                <td>‚Äî</td><td>‚Äî</td><td>‚Äî</td><td>‚Äî</td><td>‚Äî</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- (optional) cards area ‡∏ñ‡πâ‡∏≤‡∏ô‡∏≤‡∏¢‡∏¢‡∏±‡∏á‡πÉ‡∏ä‡πâ renderResultTable/renderCards -->
      <section id="cards" class="cardsArea"></section>

      <footer class="footer muted">
        Built for your FastAPI + result.json pipeline.
      </footer>
    </main>
  </div>

  <script>
    // ‡πÅ‡∏Ñ‡πà‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï statusText ‡πÉ‡∏´‡πâ‡∏î‡∏π‡πÄ‡∏ó‡πà (‡πÑ‡∏°‡πà‡∏¢‡∏∏‡πà‡∏á‡∏Å‡∏±‡∏ö app.js)
    const _setStatus = window.setStatus;
    window.setStatus = function(msg, type){
      const t = document.getElementById("statusText");
      if (t) t.textContent = type === "loading" ? "Loading..." : (type === "success" ? "OK" : (type === "error" ? "Error" : "Info"));
      if (typeof _setStatus === "function") _setStatus(msg, type);
    }

  </script>
</body>
</html>
