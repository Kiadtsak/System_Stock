import os
import os

from pydantic import SecretStr, field_validator


API_KEY: str | None = None
OPENAI_API_KEY: str | None = None
YEAR = [
    "1999", "2000", "2001", "2002", "2003", "2004", "2005", 
    "2006", "2007", "2008", "2009", "2010", "2011", "2012", 
    "2013", "2014","2015", "2016", "2017", "2018", "2019", 
    "2020", "2021", "2022", "2023", "2024", "2025", "2026", 
    "2027", "2028", "2029", "2030"
        ]
TAX_RATE = 0.21                                         # อัตราภาษีนิติบุคคล 21% สำหรับสหรัฐอเมริกา
BASE_DIR = os.path.dirname(os.path.abspath(__file__))   # โฟลเดอร์ของไฟล์ปัจจุบัน
DATA_DIR = os.path.join(BASE_DIR, "data")
RISK_FREE_RATE = 0.03                                   # อัตราผลตอบแทนที่ปราศจากความเสี่ยง (3% สำหรับสหรัฐอเมริกา)
BETA = 1.0                                                 # ค่า Beta ของหุ้น (1.0 หมายถึงความเสี่ยงเท่าตลาด)
PRICE_STOCK = float()#input("Enter the current stock price: ")  # รับราคาหุ้นจากผู้ใช้
    #__----- 
    # === ตั้งค่าโมเดลและข้อมูล ===
DATA_PATH = "exports/result.json"  # ชี้ไปไฟล์ JSON ของคุณ
MODEL_PATH = "exports/fair_value_model.pkl"
SCALER_PATH = "artifacts/scaler.pkl"
FEATURES_PATH = "artifacts/features.txt"

    # ตั้งชื่อคอลัมน์เป้าหมาย (ต้องมีในไฟล์ JSON)
    # ถ้าคุณทำ label ชื่ออื่น เช่น "Fair Value", "Intrinsic Value", "Target Price" ให้ใส่ตรงนี้
TARGET_COLUMN = "Fair Value"

    # คอลัมน์ที่ไม่ใช่ฟีเจอร์ในการเทรน
EXCLUDE_COLUMNS = ["Stock Symbol", "Year"]

#    ค่าทั่วไป
TEST_SIZE = 0.2
RANDOM_STATE = 42
N_JOBS = -1


#  AI Settings
SYSTEM_PROMPT = """
คุณเป็นนักวิเคราะห์หุ้นระดับมืออาชีพ
ใช้ข้อมูลที่ให้มาเท่านั้น ห้ามคำนวณตัวเลขใหม่
ให้วิเคราะห์ในเชิงเหตุผล ไม่โฆษณา ไม่อวยเกินจริง
"""

USER_PROMPT_TEMPLATE = """
ข้อมูลหุ้น:

[Financial Ratios]
{ratios}

[Valuation]
{valuation}

โปรดวิเคราะห์:
1. คุณภาพธุรกิจ (Quality)
2. ความถูกแพงของราคา (Valuation)
3. ความเสี่ยงหลัก
4. มุมมองการลงทุน (Bull / Neutral / Bear)
5. เหมาะกับนักลงทุนระยะไหน

ตอบเป็นภาษาไทย แบบนักลงทุนมืออาชีพ
"""




SYSTEM_PROMPT = """
คุณเป็นนักวิเคราะห์หุ้นระดับมืออาชีพ

กติกา (ต้องทำตาม):
- ใช้ข้อมูลที่ผู้ใช้ให้มาเท่านั้น ห้ามคำนวณตัวเลขใหม่ ห้ามเดาค่าที่ไม่มี
- ห้ามอ้างอิงราคาตลาด ข่าว หรือข้อมูลภายนอก (เพราะไม่ได้ให้มา)
- ห้ามโฆษณา/อวยเกินจริง/ชี้นำแบบฟันธง
- ถ้าข้อมูลไม่พอ ให้ระบุว่า "ข้อมูลไม่พอ" และบอกว่าขาดอะไร
- อ้างอิงตัวเลขโดย “ยกค่าตามที่ให้มา” พร้อมระบุปี/ช่วงเวลาเมื่อมี

รูปแบบการตอบ:
- เขียนแบบนักลงทุนมืออาชีพ กระชับ ชัดเจน
- ใช้หัวข้อและ bullet
- สรุปมุมมอง Bull/Neutral/Bear พร้อมเหตุผล 3 ข้อ
"""

USER_PROMPT_TEMPLATE = """
ต่อไปนี้คือข้อมูลหุ้นจากระบบของฉัน (เป็นข้อมูลภายใน):
ห้ามคำนวณตัวเลขใหม่ และห้ามใช้อะไรนอกเหนือจากข้อมูลนี้

[Financial Ratios] (อาจมีหลายปี)
{ratios}

[Valuation]
{valuation}

งานของคุณ:
1) คุณภาพธุรกิจ (Quality)
- จุดแข็ง (อ้างอิงตัวเลขที่มี)
- จุดอ่อน/สัญญาณเตือน (อ้างอิงตัวเลขที่มี)
- ความสม่ำเสมอของผลประกอบการ (ถ้าข้อมูลหลายปี)

2) ความถูกแพงของราคา (Valuation)
- เทียบ “ราคา vs มูลค่าเหมาะสม” เฉพาะจาก valuation ที่ให้มา
- ระบุ Margin of Safety ถ้ามีในข้อมูล (ห้ามคำนวณเอง)

3) ความเสี่ยงหลัก
- ความเสี่ยงด้านงบการเงิน (หนี้/สภาพคล่อง/กระแสเงินสด)
- ความเสี่ยงด้านความผันผวนของกำไร (ถ้าเห็นจากหลายปี)

4) มุมมองการลงทุน: Bull / Neutral / Bear
- เลือก 1 มุมมอง และให้เหตุผล 3 ข้อ (ต้องโยงกับข้อมูล)

5) เหมาะกับนักลงทุนระยะไหน
- สั้น / กลาง / ยาว (เลือกได้มากกว่า 1) พร้อมเหตุผล

ท้ายสุด:
- “สิ่งที่ควรตรวจเพิ่ม” 3–5 ข้อ (เป็นรายการ ไม่ต้องใช้เว็บ)
"""
